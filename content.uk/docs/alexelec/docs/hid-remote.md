---
title: Налаштування HID-пульта дистанційного керування
weight: 11
---

## Налаштування HID-пульта дистанційного керування в системах «LibreELEC/CoreELEC» (ae-fork)

{{% hint info %}}
HID (Human Interface Device) - це стандарт для передачі даних між комп'ютером і пристроями, які використовуються для введення даних (клавіатура, миша, джойстик)
або виведення (монітор, колонки). Пульт дистанційного керування, що підтримує HID, може взаємодіяти з комп'ютером як звичайна клавіатура або миша.
{{% /hint %}}

HID-пульти дистанційного керування мають деякі переваги над IR-пультами.
По-перше, вам не потрібно направляти пульт на приймач сигналу. По-друге, HID-пульти (оскільки вони імітують клавіатуру) підтримують функцію «довге натискання».
Це означає, що одну кнопку можна запрограмувати на дві різні дії.

У цій інструкції йдеться про пульти дистанційного керування «G20S PRO» (USB 2.4G) та «G20S PRO BT» (USB 2.4G + Bluetooth), які зовні не відрізняються,
але мають різні коди кнопок. Ми використовуватимемо лише інтерфейс «USB 2.4G».

Сервіс «HID-Remote» використовує утиліту <a target='_blank' href="https://github.com/AlexELEC/hid_mapper/blob/master/README">«hid_mapper»</a>.

<p align="center">
  <a href="/alexelec/hid-remote/01.png"><img src="/alexelec/hid-remote/01.png" width="480"/></a>
</p>

{{% hint warning %}}
Увага! Після вимкнення системи пульт переходить у режим сну.
Це заощаджує заряд батарейок, але під час наступного ввімкнення потрібно кілька разів натиснути будь-яку кнопку, щоб пульт відновив роботу.

Якщо натиснути кнопку перемикання режимів клавіатура/миша, це призведе до зміни кодів кнопок, які надсилає пульт дистанційного керування.
Відповідно, деякі кнопки можуть перестати працювати.
{{% /hint %}}

## Сервіс «HID-Remote»

Усі налаштування розташовані в каталозі «/storage/.config/hid_remote/». Надалі всі шляхи до файлів вказуватимуться відносно цього каталогу.

Для пультів «G20S PRO/G20S PRO BT» (а також для деяких інших) у системі вже існує конфігурація.
Вам потрібно лише замінити вміст файлу «remote.map» на вміст файлу «sample/Gi20sPRO.map» або «sample/Gi20sPRO-BT.map» (для G20S PRO BT)
і в файлі «device.conf» вказати значення для змінних «MANUFACTURER» та «PRODUCT».
Відповідні значення для цих змінних також містяться у згаданих «map» файлах. Після цього залишиться лише ввімкнути сервіс «HID-Remote».

<p align="center">
  <a href="/alexelec/hid-remote/02.png"><img src="/alexelec/hid-remote/02.png" width="480"/></a>
</p>

{{% hint info %}}
Під час активації сервісу «HID-Remote» сервіс «Eventlircd» буде вимкнено. Це зроблено для запобігання подвійному спрацьовуванню кнопок пульта.
{{% /hint %}}

## Самостійне налаштування конфігурації для сервісу «HID-Remote»

Якщо у вас пульт іншої моделі, вам не потрібно налаштовувати всі його кнопки.
Зазвичай можуть не працювати лише дві-три кнопки, оскільки вони надсилають код натискання одразу кількох клавіш.
Також це може знадобитися, якщо ви хочете перепризначити дію певної кнопки.

Зупиніть сервіси «Kodi» та «Eventlircd», виконавши наступні команди в терміналі:

    systemctl stop kodi
    systemctl stop eventlircd

У файлі «device.conf» необхідно встановити значення змінних «MANUFACTURER» та «PRODUCT» для вашого HID-пристрою.
Для цього виконайте команду (підказка є у файлі device.conf):

    hid-remote --list-devices --lookup-id

Якщо у вас не підключено інших пристроїв введення (крім пульта), ви побачите приблизно таке:

<p align="center">
  <a href="/alexelec/hid-remote/03.png"><img src="/alexelec/hid-remote/03.png" width="480"/></a>
</p>

Тут показано два пристрої з однаковими значеннями «Manufacturer/Product name» — це тому, що пульт визначається і як клавіатура, і як миша.

Впишіть отримані значення у файл «device.conf».

    MANUFACTURER="1915"
    PRODUCT="1025"

Тепер налаштуємо файл «remote.map», зіставивши коди кнопок пульта з потрібними клавішами клавіатури.

Формат файлу «remote.map»:

    Код_кнопки_пульта:Ім'я_клавіші_клавіатури

Наприклад:

    024100:KEY_ENTER

Визначимо код потрібної кнопки пульта. Для цього виконайте наступну команду:

    hid-remote --lookup-id --learn --manufacturer <MANUFACTURER> --product <PRODUCT>

Тут потрібно підставити значення змінних «MANUFACTURER» та «PRODUCT», які ми отримали раніше.
Натисніть на пульті потрібну кнопку та отримайте її код.

Приклад нижче демонструє код для кнопки «OK».

<p align="center">
  <a href="/alexelec/hid-remote/04.png"><img src="/alexelec/hid-remote/04.png" width="480"/></a>
</p>

    02 41 00 - код натискання кнопки
    02 00 00 - код відпускання кнопки (він майже для всіх кнопок буде однаковий)

Нам потрібен перший код. Запишіть його у файл «remote.map» без пробілів.

У файлі «sample/keys.sample» ви знайдете всі потрібні імена клавіш клавіатури.

Після редагування файлів «device.conf» та «remote.map» активуйте сервіс «HID-Remote» у налаштуваннях системи.

## Кнопка «Power»

Зазвичай кнопка «Power» на пульті дистанційного керування діє так само, як кнопка «Power» на корпусі комп'ютера: вона одразу вимикає комп'ютер.
Якщо така поведінка вас не влаштовує і ви бажаєте, щоб ця кнопка викликала меню «Shoutdown» (наприклад, для встановлення таймера), виконайте наступні кроки:

1. Скопіюйте файл «/etc/systemd/logind.conf» до каталогу «/storage/.config/logind.conf.d».

2. Відредагуйте в скопійованому файлі наступний рядок:

{{% hint %}}
    HandlePowerKey=ignore
{{% /hint %}}

Щоб зміни набули чинності, необхідно перезавантажити систему.
